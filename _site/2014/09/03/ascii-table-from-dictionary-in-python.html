<!DOCTYPE html><html lang="en" manifest="/manifest.appcache"> <!-- Magic. Do not touch! (c) 2011-2016 Maciej A. Czyzewski --><meta charset="UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><meta name="robots" content="index, follow, archive" /><meta name="referrer" content="always" /><title>ASCII table from dictionary in Python - Maciej A. Czyzewski on the Web</title><meta property="og:title" content="ASCII table from dictionary in Python" /><meta name="description" content="Sometimes I wish to print pretty table of dictionary as an ASCII, like this:" /><meta property="og:description" content="Sometimes I wish to print pretty table of dictionary as an ASCII, like this:" /><link rel="canonical" href="http://maciejczyzewski.me/2014/09/03/ascii-table-from-dictionary-in-python.html" /><meta property="og:url" content="http://maciejczyzewski.me/2014/09/03/ascii-table-from-dictionary-in-python.html" /><meta property="og:site_name" content="Maciej A. Czyzewski on the Web" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2014-09-03T19:14:00+02:00" /><link rel="next" href="http://maciejczyzewski.me/2014/10/18/bloom-filters-fast-and-simple.html" title="Bloom filters, fast and simple" /><link rel="prev" href="http://maciejczyzewski.me/2014/08/19/enable-airdrop-on-older-macs.html" title="Enable AirDrop on older Macs" /><meta name="twitter:card" content="summary" /><meta name="twitter:site" content="@_czyzewski" /><meta name="google-site-verification" content="HBawTMww3xGdm4ZIKokBD8_Bx3YudVqrv1PISdhnthE" /> <script type="application/ld+json"> { "@context": "http://schema.org", "@type": "BlogPosting", "headline": "ASCII table from dictionary in Python", "datePublished": "2014-09-03T19:14:00+02:00", "description": "Sometimes I wish to print pretty table of dictionary as an ASCII, like this:", "logo": "http://maciejczyzewski.me/assets/images/shortcuts/144.png", "url": "http://maciejczyzewski.me/2014/09/03/ascii-table-from-dictionary-in-python.html" } </script><link type="application/atom+xml" rel="alternate" href="http://maciejczyzewski.me/feed.xml" title="Maciej A. Czyzewski on the Web" /><link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Merriweather:400,300,300italic,400italic,700,700italic,900,900italic" /> <script type="text/x-mathjax-config"> MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}}); </script> <script type="text/javascript" async src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_CHTML"></script><link media="all" rel="stylesheet" type="text/css" href="/assets/styles.css" /></head><line></line><header> <a href="/">Maciej A. Czyzewski</a> <a href="/archive">Archive</a> <a href="/research">Research</a> <a href="/projects">Projects</a> <a href="/talks">Talks</a> <a href="/about">About</a></header><main><article><h1>ASCII table from dictionary in Python</h1><hgroup> <span>Posted on <time datetime="">03 September 2014</time></span> <a href="https://twitter.com/share" class="twitter-share-button" data-via="_czyzewski" data-size="large">Tweet</a><script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script></hgroup><div><p>Sometimes I wish to print pretty table of dictionary as an ASCII, like this:</p><div class="highlighter-rouge"><pre class="highlight"><code>| Github project | Number of stars | Number of watchers |
+----------------+-----------------+--------------------+
| hyhyhy         |             195 |                 12 |
| bottomline     |              17 |                  3 |
| retter         |               2 |                  2 |
| hashbase       |               1 |                  1 |
+----------------+-----------------+--------------------+
</code></pre></div><p>Surprisingly it got complicated because of variable lengths of the data. I <em>googled</em> for “standard” ways of doing this and I found suggestions like:</p><p><a href="http://stackoverflow.com/questions/5909873/python-pretty-printing-ascii-tables">http://stackoverflow.com/questions/5909873/python-pretty-printing-ascii-tables</a></p><p>Which were a bit dated and hard to read or full scale modules like:</p><ul><li><a href="http://pypi.python.org/pypi/texttable/">texttable</a> by Gerome Fournier</li><li><a href="http://pypi.python.org/pypi/text_table/">text_table</a> by Swaroop C. H.</li><li><a href="http://pypi.python.org/pypi/asciitable/">asciitable</a> by Tom Aldcroft</li></ul><p>Which were overkill. So I decided to write my own function and am quite pleased with what I got!</p><h2 id="implementation">Implementation</h2><p>Here is a simple function that generate table, where each row runs the <code class="highlighter-rouge">leftright()</code> function:</p><figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">table</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">headers</span><span class="p">):</span>
  <span class="s">"""
  Generate ASCII table
  data: list of dicts,
  headers: e.g. [('name', 'Github project'), ('stars', 'Number of stars')]
  template:
    asc_p[0]          </span><span class="si">%</span><span class="s">s         asc_s          </span><span class="si">%</span><span class="s">s         asc_p[1]
    asc_h[0] (a) * max_widths[0] asc_t (a) * max_widths[1] asc_h[1]
    asc_p[0]          </span><span class="si">%</span><span class="s">s         asc_s          </span><span class="si">%</span><span class="s">s         asc_p[1]
    asc_p[0]          </span><span class="si">%</span><span class="s">s         asc_s          </span><span class="si">%</span><span class="s">s         asc_p[1]
    asc_p[0]          </span><span class="si">%</span><span class="s">s         asc_s          </span><span class="si">%</span><span class="s">s         asc_p[1]
    asc_p[0]          </span><span class="si">%</span><span class="s">s         asc_s          </span><span class="si">%</span><span class="s">s         asc_p[1]
    asc_h[0] (a) * max_widths[0] asc_t (a) * max_widths[1] asc_h[1]
  table e.g.:
       | Github project            | Files                    |
       +---------------------------+--------------------------+
       | long_repo_but_empty_hyhyh | 234234342354345645645612 |
       | bottomline                |                       56 |
       | retter                    |                        5 |
       | hashbase                  |                       73 |
       +---------------------------+--------------------------+
  """</span>

  <span class="c"># Processing</span>
  <span class="n">max_widths</span><span class="p">,</span> <span class="n">data_copy</span><span class="p">,</span> <span class="n">final</span> <span class="o">=</span> <span class="p">{},</span> <span class="p">[</span><span class="nb">dict</span><span class="p">(</span><span class="n">headers</span><span class="p">)]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="s">''</span>

  <span class="n">a</span><span class="p">,</span> <span class="n">asc_s</span><span class="p">,</span> <span class="n">asc_t</span><span class="p">,</span> <span class="n">asc_p</span><span class="p">,</span> <span class="n">asc_h</span> <span class="o">=</span> <span class="s">'-'</span><span class="p">,</span> <span class="s">' | '</span><span class="p">,</span> <span class="s">'-+-'</span><span class="p">,</span> <span class="s">'| </span><span class="si">%</span><span class="s">s |</span><span class="se">\n</span><span class="s">'</span><span class="p">,</span> <span class="s">'+-</span><span class="si">%</span><span class="s">s-+</span><span class="se">\n</span><span class="s">'</span>

  <span class="c"># Analyse</span>
  <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">data_copy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
    <span class="n">max_widths</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="n">col</span><span class="p">]))</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">data_copy</span><span class="p">])</span>
  <span class="n">cols_order</span> <span class="o">=</span> <span class="p">[</span><span class="n">tup</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">tup</span> <span class="ow">in</span> <span class="n">headers</span><span class="p">]</span>

  <span class="c"># Filter</span>
  <span class="k">def</span> <span class="nf">leftright</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">==</span> <span class="nb">int</span><span class="p">:</span>
      <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="n">max_widths</span><span class="p">[</span><span class="n">col</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="k">return</span> <span class="n">value</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="n">max_widths</span><span class="p">[</span><span class="n">col</span><span class="p">])</span>

  <span class="c"># Final</span>
  <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data_copy</span><span class="p">):</span>   
    <span class="n">row_str</span> <span class="o">=</span> <span class="n">asc_s</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">leftright</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="n">row</span><span class="p">[</span><span class="n">col</span><span class="p">])</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">cols_order</span><span class="p">])</span>
    <span class="n">final</span> <span class="o">=</span> <span class="n">final</span> <span class="o">+</span> <span class="n">asc_p</span> <span class="o">%</span> <span class="n">row_str</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">data_copy</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">row</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span>  
        <span class="n">data_copy</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">row</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data_copy</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)):</span> <span class="c"># Header &amp; Footer   </span>
      <span class="n">line</span> <span class="o">=</span> <span class="n">asc_t</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">a</span> <span class="o">*</span> <span class="n">max_widths</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">cols_order</span><span class="p">])</span>
      <span class="n">final</span> <span class="o">=</span> <span class="n">final</span> <span class="o">+</span> <span class="n">asc_h</span> <span class="o">%</span> <span class="n">line</span>

  <span class="c"># Remove last '\n'</span>
  <span class="k">return</span> <span class="n">final</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span></code></pre></figure><h2 id="testing">Testing</h2><p>Now it’s time to play code.</p><figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">data</span> <span class="o">=</span> <span class="p">[</span>
  <span class="p">{</span><span class="s">'name'</span><span class="p">:</span> <span class="s">'hyhyhy'</span><span class="p">,</span>     <span class="s">'stars'</span><span class="p">:</span> <span class="mi">195</span><span class="p">,</span> <span class="s">'watchers'</span><span class="p">:</span> <span class="mi">12</span><span class="p">},</span>
  <span class="p">{</span><span class="s">'name'</span><span class="p">:</span> <span class="s">'bottomline'</span><span class="p">,</span> <span class="s">'stars'</span><span class="p">:</span> <span class="mi">17</span><span class="p">,</span>  <span class="s">'watchers'</span><span class="p">:</span> <span class="mi">3</span><span class="p">},</span>
  <span class="p">{</span><span class="s">'name'</span><span class="p">:</span> <span class="s">'retter'</span><span class="p">,</span>     <span class="s">'stars'</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>   <span class="s">'watchers'</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span>
  <span class="p">{</span><span class="s">'name'</span><span class="p">:</span> <span class="s">'hashbase'</span><span class="p">,</span>   <span class="s">'stars'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>   <span class="s">'watchers'</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
<span class="p">]</span>

<span class="n">headers</span> <span class="o">=</span> <span class="p">[</span>
  <span class="p">(</span><span class="s">'name'</span><span class="p">,</span>     <span class="s">'Github project'</span><span class="p">),</span>
  <span class="p">(</span><span class="s">'stars'</span><span class="p">,</span>    <span class="s">'Number of stars'</span><span class="p">),</span>
  <span class="p">(</span><span class="s">'watchers'</span><span class="p">,</span> <span class="s">'Number of watchers'</span><span class="p">)</span>
<span class="p">]</span>

<span class="k">print</span> <span class="n">table</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">headers</span><span class="p">)</span></code></pre></figure><p>Remember! Wikipedia is lying… My table is better.</p><blockquote><p>A table is a form of furniture with a flat horizontal upper surface used to support objects of interest, for storage, show, and/or manipulation.</p></blockquote><h2 id="thanks">Thanks</h2><p><strong>Luke Vincent</strong> - Improved code, repaired mistakes.</p></div><nav> <a href="/2014/08/19/enable-airdrop-on-older-macs.html"><p>« previus</p><span>Enable AirDrop on older Macs</span> </a> <a href="/2014/10/18/bloom-filters-fast-and-simple.html"><p>next »</p><span>Bloom filters, fast and simple</span> </a></nav></article></main><footer> (c) 2016 <a href="/feed.xml"><svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" fill-rule="evenodd" clip-rule="evenodd" stroke-linejoin="round" stroke-miterlimit="1.414"><path d="M12.8 16C12.8 8.978 7.022 3.2 0 3.2V0c8.777 0 16 7.223 16 16h-3.2zM2.194 11.61c1.21 0 2.195.985 2.195 2.196 0 1.21-.985 2.194-2.196 2.194C.984 16 0 15.017 0 13.806c0-1.21.983-2.195 2.194-2.195zM10.606 16h-3.11c0-4.113-3.383-7.497-7.496-7.497v-3.11c5.818 0 10.606 4.79 10.606 10.607z"/></svg></a></footer><script type="text/javascript">(function(e,t,n,r,i,s,o){e["GoogleAnalyticsObject"]=i;e[i]=e[i]||function(){(e[i].q=e[i].q||[]).push(arguments)},e[i].l=1*new Date;s=t.createElement(n),o=t.getElementsByTagName(n)[0];s.async=1;s.src=r;o.parentNode.insertBefore(s,o)})(window,document,"script","//www.google-analytics.com/analytics.js","ga");ga("create","UA-55884794-1","auto");ga("send","pageview")</script></body></html>
